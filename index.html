<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie's Anywhere | Universal Hub</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js" crossorigin="anonymous"></script>

    <style>
        :root {
            --bg-main: #0a0a0a; 
            --ma-blue: #0099ff;
            --amazon-orange: #ff9900;
            --yt-red: #ff0000;
            --goog-blue: #4285f4;
            --goog-green: #34a853;
            --container-width: 90%; 
        }

        /* SUNSET / NIGHT MODE */
        body.night-mode {
            --bg-main: #050505;
            --ma-blue: #ff9800;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
            background-color: var(--bg-main);
            color: #ffffff;
            margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
            transition: all 0.8s ease-in-out;
        }

        /* üåç THE UNIVERSAL GLOBE MENU */
        #universal-nav {
            width: var(--container-width);
            margin: 20px auto;
            padding: 15px;
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid #333;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            margin-left: 15px;
            font-weight: bold;
            font-size: 0.85rem;
        }

        .nav-links a:hover { color: var(--ma-blue); }

        /* MOVIE GRID */
        #movie-container {
            width: var(--container-width);
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 50px;
        }

        .movie-card {
            background: #1a1a1a;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #333;
            transition: transform 0.3s;
        }

        .movie-card:hover { transform: scale(1.05); border-color: var(--ma-blue); }
        .poster { width: 100%; aspect-ratio: 2/3; object-fit: cover; display: block; }
        .card-content { padding: 10px; text-align: center; }
        .movie-title { font-size: 0.8rem; font-weight: bold; margin-bottom: 8px; height: 2.4em; overflow: hidden; }
        
        .btn-link { 
            display: inline-block; 
            padding: 5px 10px; 
            font-size: 0.7rem; 
            text-decoration: none; 
            color: white; 
            background: var(--ma-blue); 
            border-radius: 4px;
            margin: 2px;
        }

        /* Mobile View */
        @media (max-width: 768px) {
            #universal-nav { flex-direction: column; gap: 10px; }
            .nav-links { margin: 0; }
            #movie-container { grid-template-columns: repeat(2, 1fr); gap: 10px; }
        }
    </style>
</head>
<body>

    <nav id="universal-nav">
        <div style="font-weight: 900; letter-spacing: 1px;">
            <span style="color: var(--ma-blue);">WEREWOLF</span> HUB
        </div>
        <div id="dynamic-menu" class="nav-links"></div>
    </nav>

    <div id="movie-container">Syncing Cinema Library...</div>

    <script>
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRbnwK6U18P1u1eAS8a_PqZzpOKxQ9AATL6RBH7CfxXQR10YPM63akRqxSDbNiXYJWs92tvobh6iqE7/pub?output=csv';

        // 1. DYNAMIC MENU LOGIC
        function loadMenu() {
            const menuConfig = {
                "kfruti88.github.io": [
                    { name: "Phoenix", url: "https://werewolf.ourflora.com/phoenix-darkfire/" },
                    { name: "Ray", url: "https://werewolf.ourflora.com/home/ray-2/" },
                    { name: "Main Site", url: "https://werewolf.ourflora.com/" }
                ],
                "werewolf.ourflora.com": [
                    { name: "Movies", url: "https://kfruti88.github.io/Movies-Anywhere/" },
                    { name: "Friends", url: "#" }
                ]
            };
            const host = window.location.hostname;
            const links = menuConfig[host] || menuConfig["kfruti88.github.io"];
            const menuBox = document.getElementById('dynamic-menu');
            links.forEach(link => {
                const a = document.createElement('a');
                a.href = link.url;
                a.textContent = link.name;
                menuBox.appendChild(a);
            });
        }

        // 2. SUNRISE/SUNSET
        function checkSun() {
            const hour = new Date().getHours();
            if (hour < 6 || hour >= 18) {
                document.body.classList.add('night-mode');
            }
        }

        // 3. MOVIE RENDERING
        function renderMovies(data) {
            const container = document.getElementById('movie-container');
            container.innerHTML = '';
            data.forEach(movie => {
                if(!movie['Movie Name']) return;
                const card = document.createElement('div');
                card.className = 'movie-card';
                card.innerHTML = `
                    <img class="poster" src="${movie['Movie Image']}" onerror="this.src='https://placehold.co/200x300?text=No+Image'">
                    <div class="card-content">
                        <div class="movie-title">${movie['Movie Name']}</div>
                        <a href="${movie['Amazon']}" class="btn-link" target="_blank">Watch</a>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function initMovies() {
            Papa.parse(csvUrl, {
                download: true,
                header: true,
                complete: function(results) {
                    renderMovies(results.data);
                }
            });
        }

        // SINGLE ONLOAD GATEKEEPER
        window.onload = () => {
            loadMenu();
            checkSun();
            initMovies();
        };
    </script>
</body>
</html>
